<!DOCTYPE html>
<style>
	html{
	}
	body{
		background-color: white;

	}
	div{
		position: relative;
	}
	input[type=submit]{
		background-color: #696969;
		border-radius: 0;
		width: 110px;
		height: 30px;
		color: white;
	}
	input[type=text], [type=submit]{
		font-size: 14px;
	}
	input[type=text]{
		height: 25px;
		border: 2px solid #696969;
	}
	#exportButton{
		width: 140px;
		padding-right: 30px;
		padding-left: 30px;
		padding-top: 5px;
		padding-bottom: 5px;
		background-color: #696969;
		color: white;
		text-decoration: none;
	}
	#submitButton{
		width: 160px;
	}
	div#export{
		right: 15%;
		margin-top: -52px;
		position: absolute;
		font-family: system-ui;
	}
	div#newInput{
		padding-top: 10px;
		padding-bottom: 10px;
	}
	form#inputForm{
		text-align: center;
	}
	h1#title{
		text-align: center;
		font-size: 24pt;
		font-family: system-ui;
	}
	div#mainSpace{
		padding-top: 5px;
		width: 100%;
		margin: 0 auto;
		display: block;
	}
	img#mainCollage{
		min-width: 800px ;
		min-height: 600px;
		max-width: 70vw;
		max-height: 50vh;
		margin: 0 auto;
		display: block;
	}
	img.galleryImage{
		height: 80px;
		margin-left: 5px;
		margin-right: 5px;
	}
	a.galleryLink{
		height: 80px;
	}
	div#galleryOuter{
		width: 800px;
		height: 80px;
		margin: 0 auto;
		overflow: scroll;
	}
	div#galleryInner{
		overflow-x: scroll;
		overflow-y: hidden;
		white-space: nowrap;
		height: 80px;
		margin: 0 auto;
	}

</style>
<html>
<head>
	<meta charset="UTF-8">
	<title>Build Another Collage</title>
	</head>
	<body>
		<div id="header">
			<h1 id="title">Collage for Topic Halfond</h1>
			<div id="export">
				<!-- <form name="export" id="export" method="POST" action="" enctype="multipart/form-data">
					<input type="Submit" id="exportButton" name="export" value="Export" />
				</form> -->
				<a id = "exportButton" onclick="prepareDownload()" download>Export</a>
			</div>
		</div>
		<div id="mainSpace">
			<img id="mainCollage" src="http://www-bcf.usc.edu/~halfond/pics/headshot.jpg">
		</div>
		<div id="newInput">
			<form name="enterTopic" id="inputForm" method="POST" action="" enctype="multipart/form-data">
				<input type="text" id="inputBox" name="topic" placeholder="Enter topic" onkeyup="editingStopped()"/>
				<input type="Submit" id="submitButton" name="build" value="Build Another Collage" disabled />
			</form>
		</div>
		<div id="galleryOuter">
			<div id="galleryInner">
				<a id="galleryCollage-1" class="galleryLink" style="display: none" onclick="clickedGallery('1')">
					<img class="galleryImage" src="http://www-bcf.usc.edu/~halfond/pics/headshot.jpg" alt="Halfond">
				</a>
				<a id="galleryCollage-2" class="galleryLink" onclick="clickedGallery('2')">
					<img class="galleryImage" src="http://www.shapecollage.com/collages/collage-popart.jpg" alt="Collage">
				</a>
				<a id="galleryCollage-3" class="galleryLink" onclick="clickedGallery('3')">
					<img class="galleryImage" src="https://d2q79iu7y748jz.cloudfront.net/s/_squarelogo/543c245dd9bef5de74267dbf6c54a86e" alt="USC">
				</a>
				<a id="galleryCollage-4" class="galleryLink" onclick="clickedGallery('4')">
					<img class="galleryImage" src="https://s.abcnews.com/images/US/cute-dogs-gty-01-jpo-171116_12x5_992.jpg" alt="Dogs">
				</a>
				<a id="galleryCollage-5" class="galleryLink" onclick="clickedGallery('5')">
					<img class="galleryImage" src="https://cdn.vox-cdn.com/thumbor/avciGramUJ8ljFGsKgmiBxShiS8=/0x0:3052x1934/1200x800/filters:focal(1282x723:1770x1211)/cdn.vox-cdn.com/uploads/chorus_image/image/55470069/669120050.0.jpg" alt="Soccer">
				</a>
				<a id="galleryCollage-6" class="galleryLink" onclick="clickedGallery('6')">
					<img class="galleryImage" src="http://itmusings.com/pblog/300languages/100java/images/oracle_java.jpg" alt="Java">
				</a>
				<a id="galleryCollage-7" class="galleryLink" onclick="clickedGallery('7')">
					<img class="galleryImage" src="https://static.pexels.com/photos/204611/pexels-photo-204611.jpeg" alt="Computer">
				</a>
				<a id="galleryCollage-8" class="galleryLink" onclick="clickedGallery('8')">
					<img class="galleryImage" src="https://i.ytimg.com/vi/p3NXd3DhH08/maxresdefault.jpg" alt="Skateboard">
				</a>
			</div>
		</div>
	</body>
</html>

<script type="text/javascript">
	function editingStopped(){
        if(document.getElementById('inputBox').value.trim().length > 0) { 
            document.getElementById('submitButton').disabled = false; 
        } else { 
            document.getElementById('submitButton').disabled = true;
        }
    }
    function prepareDownload(){
		var img = document.getElementById('mainCollage');

    	// var canvas = document.createElement('canvas');
    	// canvas.id = "myCanvas";
    	// canvas.height = img.height;
    	// canvas.width = img.width;
    	// console.log('hi');
    	// console.log(canvas.width);
    	// console.log(canvas.height);
    	// context = canvas.getContext('2d');
    	// context.drawImage(img,0,0);
    	// var newImg = canvas.toDataURL('image.png');
    	// var exportDiv = document.getElementById('exportButton1');
    	// exportDiv.href = newImg;

    	var exportDiv = document.getElementById('exportButton');
    	exportDiv.href = img.src
    }
    function clickedGallery(divNum){
    	var clickedImgId = ("galleryCollage-" + divNum);
    	var galleryMainDiv = document.getElementById('galleryInner');
    	var galleryImages = galleryMainDiv.children;
    	for(i=0; i<galleryImages.length;i++){
    		if(galleryImages[i].id == clickedImgId){
    			galleryImages[i].style.display = 'none';
    		} else{
    			galleryImages[i].style.display = 'inline-block';
    		}
    	}

    	var clickedImgContainer = document.getElementById(clickedImgId);
    	var clickedImg = clickedImgContainer.children[0];
    	var mainCollageImg = document.getElementById('mainCollage');
    	mainCollageImg.src = clickedImg.src;

    	var collageTitle = document.getElementById('title');
    	console.log(collageTitle);
    	var imgTopic = clickedImg.alt;
    	collageTitle.innerHTML = ('Collage for topic ' + imgTopic);

    }
</script>